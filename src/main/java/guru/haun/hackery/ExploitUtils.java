package guru.haun.hackery;

import guru.haun.hackery.exploits.IExploit;

import java.util.ArrayList;
import java.util.Collection;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;


public class ExploitUtils {
	private static Map<Integer,IExploit> ex = new HashMap<Integer,IExploit>();
	
	public static  IExploit getExploitById(int i){
		return ex.get(i);
	}
	
	public static Map<Integer,IExploit> getAllExploits() {
		return ex;
	}
	
	public static IExploit pickExploit(){
		double totalWeight = totalWeightOfExploits(ex);
		int ri = -1;
		double random = Math.random() * totalWeight;
		for(int i = 0; i < ex.size(); i++){
			random -= ex.get(i).getWeight();
			if(random <= 0d){
				ri = i;
				break;
			}
		}
		return ex.get(ri);
		
	}
	
	private static double totalWeightOfExploits (Map<Integer,IExploit> exlist){
		double ret = 0d;
        for (IExploit e : exlist.values()) {
            ret += e.getWeight();
        }
		return ret;
	}
	
	public static void addExploit(IExploit ie){
		ex.put(ie.getId(),ie);
	}
}
